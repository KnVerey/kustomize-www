<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Iterating on Releases</title>
	
	<meta name="author" content="Replicated">
	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png" />
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png" />
	<link rel="icon" type="image/png" href="/favicons/favicon-196x196.png" sizes="196x196" />
	<link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16" />
	<link rel="icon" type="image/png" href="/favicons/favicon-128.png" sizes="128x128" />
	<meta name="application-name" content="&nbsp;"/>
	<meta name="msapplication-TileColor" content="#FFFFFF" />
	<meta name="msapplication-TileImage" content="mstile-144x144.png" />
	<meta name="msapplication-square70x70logo" content="mstile-70x70.png" />
	<meta name="msapplication-square150x150logo" content="mstile-150x150.png" />
	<meta name="msapplication-wide310x150logo" content="mstile-310x150.png" />
	<meta name="msapplication-square310x310logo" content="mstile-310x310.png" />
	<link rel="stylesheet" href='/css/style-7a29e25363.css'>
	<link rel="stylesheet" href='/css/featherlight.min.css'>
	<link rel="stylesheet" href="/css/highlight/prism.css">
	
	<meta name="generator" content="Hugo 0.26" />
	
	<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
	<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
</head>
<body>
	<header>
		<nav>
			<div class="container u-position--relative">
				<a href="/search" id="mobile-search" class="searchIcon--white"></a>
				<span id="toggleNav" class="u-show--mobileTablet icon u-cursor--pointer"></span>
				<ul class="nav-list paddingContainer u-position--relative">
					<li>
						<a class="logo-link" href="/">
							<img width="109" src="/images/logo@2x.png"/>
						</a>
					</li>
					<li>
						<ul id="headerLinks" class="header-links">
							
								<li><a href="/guides/">Guides</a></li>
							
								<li><a href="/docs/native/getting-started/overview/">Documentation</a></li>
							
								<li><a href="/api/">API Reference</a></li>
							
								<li><a href="https://help.replicated.com/community/">Community</a></li>
							
							<li>
								<div class="search-form">
									<input type="text" placeholder="What are you looking for?" id="search-field" style="display: none;" />
									<span class="searchIcon--white" id="desktop-search"></span>
								</div>
							</li>
							<li class="log-in-link">
								<span><a href="https://vendor.replicated.com" target="_blank">Log in</a></span>
								
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</nav>
	</header>

<main>
    <article class="single">
            
                <div class="u-gradient--swarm main-section header flex-column flex1 justifyContent--center">
            
            <div class="container">
                <div class="paddingContainer">
                    <div class="flex flex-auto u-width--full justifyContent--spaceBetween alignItems--center u-marginTop--more">
                        <div class="u-width--full u-marginRight--more">
                            <h1 class="u-color--white u-fontWeight--bold u-fontSize--header u-textAlign--left">Iterating on Releases</h1>
                            <p class="u-fontSize--normal u-fontWeight--medium u-color--white u-marginTop--normal u-lineHeight--normal">Iterate on Applications by Deploying New Features</p>
                        </div>
                        <div class="flex-auto u-hidden--mobileTablet">
                            <span class="icon u-replicatedDockerSwarm u-marginRight--normal"></span>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="container">
            <div class="paddingContainer">
                <div class="u-flexTabletReflow flex1">
                    <div class="flex-auto sidebar-wrapper">
                        <div class="sidebar">
                            <div>
                                
                                    <h3 class="u-fontWeight--medium u-borderBottom--gray u-paddingBottom--normal u-marginBottom--normal">Docker Swarm Guide</h3>
                                    <ul>
                                    
                                    
                                        
                                            
                                                
                                                    <li><a href="/guides/ship-with-docker-swarm/create-swarm-app/" class="u-color--curiousBlue">Creating a Replicated &#43; Swarm Release</a></li>
                                                
                                            
                                        
                                            
                                                
                                                    <li><a href="/guides/ship-with-docker-swarm/installing/" class="u-color--curiousBlue">Installing Replicated</a></li>
                                                
                                            
                                        
                                            
                                                
                                                    <li class="blue"><a href="/guides/ship-with-docker-swarm/iterating/">Iterating on Releases</a></li>
                                                
                                            
                                        
                                    
                                </ul>
                                
                            </div>
                        </div>
                    </div>
                    <div class="flex1 page-content-wrapper">
                        <div class="page-content">
                            
<h2 class="linked-headline" id="iterating-on-releases">
    <a href="/guides/ship-with-docker-swarm/iterating/#iterating-on-releases" class="anchor" id="#iterating-on-releases"></a>
    Iterating on Releases
</h2>


<p>In this guide, we will extend on the Redis service we released in earlier guides. If you haven&rsquo;t created and installed a Redis service via Replicated on Swarm, please start with <a href="../create-swarm-app">Creating a Swarm App</a> and <a href="../installing">Installing</a>.</p>


<h2 class="linked-headline" id="iterating-on-releases">
    <a href="/guides/ship-with-docker-swarm/iterating/#iterating-on-releases" class="anchor" id="#iterating-on-releases"></a>
    Iterating on Releases
</h2>


<p>Now that our Redis service is running on a Replicated on Swarm install, it is time to start iterating on and deploying releases for our application. While Software as a Service deployment environments are often static to your environment, enterprise environments are diverse and require the ability to adapt your service to their environments.</p>

<p>In this guide, we will add a configuration value to set the Redis timeout, create a Redis configuration file, and template this Redis configuration to match this configured timeout. When the configuration is changed, a new configuration value will be written and used by our application.</p>

<p><img src="/images/guides/swarm/iterating/1-releases.png" alt="" /></p>

<p>To start iterating on our application, navigate to the Releases dashboard from the Replicated Vendor Portal. On this dashboard, you will see the first release that we created. At the top, click the &ldquo;Create release&rdquo; button. Once again, we are on the Create a Release page with the YAML editor that we used in <a href="../create-swarm-app">Creating a Swarm App</a>. This time the content reflects the last release we created, and includes our Redis service.</p>


<h2 class="linked-headline" id="add-configuration-option">
    <a href="/guides/ship-with-docker-swarm/iterating/#add-configuration-option" class="anchor" id="#add-configuration-option"></a>
    Add Configuration Option
</h2>


<p>The first part of updating our release YAML is adding the new configuration option to the release. This is done in the <code># kind: replicated</code> section, and a default field for the hostname has been provided for us. We don&rsquo;t need this value, so replace it with some text that specifies our Redis timeout:</p>

<pre><code class="language-yaml">config:
- name: redis
  title: Redis Configuration
  description: Redis Configuration Items
  items:
  - name: timeout
    title: Timeout
    type: text
    required: true
</code></pre>

<p>This YAML defines a configuration option named <code>redis.timeout</code> that is required. On the right, our preview has updated to match this new config option.</p>

<p><img src="/images/guides/swarm/iterating/2-config-preview.png" alt="" /></p>

<p>Next, we will template this field into a redis configuration file and expose that file to our Redis service.</p>


<h2 class="linked-headline" id="add-swarm-configuration">
    <a href="/guides/ship-with-docker-swarm/iterating/#add-swarm-configuration" class="anchor" id="#add-swarm-configuration"></a>
    Add Swarm Configuration
</h2>


<p>As of Docker Compose 3.3, Swarm is now able to use configuration files as part of the Docker Compose manifest. To use this, we must define a Swarm configuration section in our <code># kind: replicated</code> section that we will use in our <code># kind: scheduler-swarm</code> section. Below <code>config:</code>, but above the start of our Swarm definition, add the following YAML:</p>

<pre><code class="language-yaml">swarm:
  configs:
  - name: redis_config
    value: |
      bind 127.0.0.1
      port 6379
      timeout {{repl ConfigOption &quot;redis.timeout&quot; }}
</code></pre>

<p>This specifies a <code>redis_config</code> configuration value that we can use in our Compose spec. Due to the mechanics of the Swarm integration, this config must be specified as an external use that will get injected by Replicated when it is scheduled. At the bottom of the <code># kind: scheduler-swarm</code> section, add the following YAML:</p>

<pre><code class="language-yaml">configs:
  redis_config:
    external: true
</code></pre>

<p>This specifies our redis_config as an external source pre-defined in <code>docker config</code>. When scheduling our application, Replicated will create this Docker config so that it can be used by our application.</p>

<p>The last step we need to take is to tie this configuration option into our Redis service as a file. Change our Redis service to:</p>

<pre><code class="language-yaml">services:
  redis:
    image: redis:3.2-alpine
    command: &quot;redis-server /usr/local/etc/redis/redis.conf&quot;
    configs:
    - source: redis_config
      target: /usr/local/etc/redis/redis.conf
</code></pre>

<p>The <code>configs</code> section takes our external <code>redis_config</code> file as a source, and mounts it to the target location inside of the service container. Because Redis takes a configuration file as it&rsquo;s first argument, we explicitly supply a command to the service definition to use this file.</p>

<p>The last thing we need to do is update our Swarm version. When creating our application, we specified version 3, but configs were introduced in 3.3. Update the first line of our <code># kind: scheduler-swarm</code> to:</p>

<p><code>version: '3.3'</code></p>

<p>By the end, our release should look something like this:</p>

<pre><code class="language-yaml">---
# kind: replicated

replicated_api_version: 2.9.2
name: &quot;myredisapp&quot;

properties:
  console_title: &quot;myredisapp&quot;

config:
- name: redis
  title: Redis Configuration
  description: Redis Configuration Items
  items:
  - name: redis_timeout
    title: Timeout
    type: text
    required: true

swarm:
  configs:
  - name: redis_config
    value: |
      bind 127.0.0.1
      port 6379
      timeout {{repl ConfigOption &quot;redis_timeout&quot; }}

---
# kind: scheduler-swarm
version: '3.3'
services:
  redis:
    image: redis:3.2-alpine
    command: &quot;redis-server /usr/local/etc/redis/redis.conf&quot;
    configs:
    - source: redis_config
      target: /usr/local/etc/redis/redis.conf

configs:
  redis_config:
    external: true
</code></pre>

<p>This release is now ready. Save it and return to the Releases dashboard.</p>

<p>We can now promote this release and update the instance we created in the <a href="../installing">Installing</a> section.</p>


<h2 class="linked-headline" id="promote-release">
    <a href="/guides/ship-with-docker-swarm/iterating/#promote-release" class="anchor" id="#promote-release"></a>
    Promote Release
</h2>


<p><img src="/images/guides/swarm/iterating/4-promote-release.png" alt="" /></p>

<p>The Release Dashboard shows 2 releases now. We can see that release sequence 1 is pinned to Unstable. Before updates are propagated to channels, we must update the channel to the release we want. Click &ldquo;Promote&rdquo; next to release sequence 2, check the &ldquo;Unstable&rdquo; channel, and promote the release.</p>

<p>Our release is now the current version for the &ldquo;Unstable&rdquo; channel. It&rsquo;s now time to update our application.</p>


<h2 class="linked-headline" id="update-application">
    <a href="/guides/ship-with-docker-swarm/iterating/#update-application" class="anchor" id="#update-application"></a>
    Update Application
</h2>


<p><img src="/images/guides/swarm/iterating/5-dashboard.png" alt="" /></p>

<p>The <a href="../installing">Installing</a> section required us to install Replicated and a license onto a new server. Return to that server&rsquo;s dashboard with our running application. The base dashboard has a &ldquo;Check Now&rdquo; button that we can use to discover and update to our new release. Click it, and we will be prompted to install the new release.</p>

<p><img src="/images/guides/swarm/iterating/6-update-available.png" alt="" /></p>

<p>Click &ldquo;View Update&rdquo; to go to the updates page. This page lists the release history for this application. Install the update by clicking the &ldquo;Install Update&rdquo; button.</p>

<p><img src="/images/guides/swarm/iterating/7-install-update.png" alt="" /></p>

<p>After the release is installed, we need to re-configure our application to start it. Go to the &ldquo;Settings&rdquo; page where our new timeout value is available. Enter a number like <code>0</code> to disable it and return to the Dashboard to start our application.</p>

<p><img src="/images/guides/swarm/iterating/8-settings.png" alt="" /></p>


<h2 class="linked-headline" id="next-steps">
    <a href="/guides/ship-with-docker-swarm/iterating/#next-steps" class="anchor" id="#next-steps"></a>
    Next Steps
</h2>


<p>You have successfully created a Docker Swarm app, converted it into a Replicated on Swarm application, and deployed it to a running server running Swarm. From there, you created a new release to make it configurable for your end users.</p>

<p>You&rsquo;re ready to begin customizing this application to meet your needs, or create a new one from scratch. As always, we are here to help you succeed on building your application in Replicated. For more help, check our <a href="https://help.replicated.com/community/">community</a> or our <a href="/docs/swarm/getting-started/overview/">Swarm documentation</a>.</p>

                            <div class="prev-next-arrows justifyContent--spaceBetween flex u-marginTop--most">
                                <div class="next flex u-textAlign--left">
                                
                                    
                                        <a href="/guides/ship-with-docker-swarm/installing/">
                                            <span class="icon u-chevronIcon"></span>
                                            Installing Replicated
                                        </a>
                                    
                                
                                </div>
                                <div class="previous flex u-textAlign--right">
                                
                                    
                                
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            
        </div>
    </article>
</main>
	<footer>
		<div class="container">
			<div class="footer-items-wrapper">
        <div class="footer-list flex1 paddingContainer">
					<div class="footer-list-item">
  <div class="footer-item">
    <div class="u-paddingBottom--normal">
      <a target="_blank" class="u-cursor--pointer" href="https://www.replicated.com">
        <img width="130" src="/images/footer_logo@2x.png"/>
      </a>
    </div>
    <div class="u-fontSize--small u-color--dustyGray u-marginBottom--small u-hidden--mobileTablet">&copy; 2018 <a> &nbsp;Replicated Inc.</a></div>
    <div class="u-fontSize--small u-color--dustyGray u-hidden--mobileTablet">All Rights Reserved</div>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Help Center</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/guides">Guides</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/docs">Documentation</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/api">API Reference</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://vendor.replicated.com/support">Contact Support</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Company</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.replicated.com">About Replicated</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://blog.replicated.com">Replicated Blog</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.replicated.com/careers">Careers</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover">RSS Feed</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Contact</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://twitter.com/replicatedhq">Twitter</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="mailto:contact@replicated.com">Email</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">More</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://github.com/replicatedhq">GitHub</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.enterpriseready.io">EnterpriseReady.io</a></li>
    </ul>
  </div>
</div>

        </div>
			</div>
		</div>
	</footer>

	
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-61084834-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
      </script>
    
 
	<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
	<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>

  
  

    
    
      
        <script src="/js/prod/autocomplete-search.js"></script>
      
      
    

  

	<script src="/js/prism.js"></script>
	<script>
		function toggleMenuClass() {
			this.classList.toggle("open");
			document.getElementById("headerLinks").classList.toggle("show");
		}
		const toggleMenu = document.getElementById("toggleNav");
		if (toggleMenu) {
			toggleMenu.addEventListener("click", toggleMenuClass);
		};
	</script>

  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <script src="/js/featherlight.min.js"></script>
	<script>
		$('#desktop-search').on("click", function () {
      if(!$('#search-field').is(":visible")) {
        $('#search-field').show("slide", { direction: "right" }, 300);
        $('#search-field').focus();
      }
		});

    $('#search-field').on("blur", function () {
      $(this).hide("slide", { direction: "right" }, 300);
    });

    $('#dropdown-link').on('click', function() {
      $('#scheduler-dropdown-menu').toggle();
    });

    $(document).on('click', function(e) {
      var target = e.target;
      if(target.id !== "dropdown-link") {
        $('#scheduler-dropdown-menu').hide();
      }
    });

    $('.tooltip').tooltip({
      position: {  my: "center bottom-10", at: "center top"  },
      show: { effect: "fade", duration: 200 },
      hide: { effect: "fade", duration: 200 }
    });
	</script>
</body>
</html>
