<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Commands</title>
	
	<meta name="author" content="Replicated">
	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png" />
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png" />
	<link rel="icon" type="image/png" href="/favicons/favicon-196x196.png" sizes="196x196" />
	<link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16" />
	<link rel="icon" type="image/png" href="/favicons/favicon-128.png" sizes="128x128" />
	<meta name="application-name" content="&nbsp;"/>
	<meta name="msapplication-TileColor" content="#FFFFFF" />
	<meta name="msapplication-TileImage" content="mstile-144x144.png" />
	<meta name="msapplication-square70x70logo" content="mstile-70x70.png" />
	<meta name="msapplication-square150x150logo" content="mstile-150x150.png" />
	<meta name="msapplication-wide310x150logo" content="mstile-310x150.png" />
	<meta name="msapplication-square310x310logo" content="mstile-310x310.png" />
	<link rel="stylesheet" href='/css/style-7a29e25363.css'>
	<link rel="stylesheet" href='/css/featherlight.min.css'>
	<link rel="stylesheet" href="/css/highlight/prism.css">
	
	<meta name="generator" content="Hugo 0.26" />
	
	<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
	<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
</head>
<body>
	<header>
		<nav>
			<div class="container u-position--relative">
				<a href="/search" id="mobile-search" class="searchIcon--white"></a>
				<span id="toggleNav" class="u-show--mobileTablet icon u-cursor--pointer"></span>
				<ul class="nav-list paddingContainer u-position--relative">
					<li>
						<a class="logo-link" href="/">
							<img width="109" src="/images/logo@2x.png"/>
						</a>
					</li>
					<li>
						<ul id="headerLinks" class="header-links">
							
								<li><a href="/guides/">Guides</a></li>
							
								<li><a href="/docs/native/getting-started/overview/">Documentation</a></li>
							
								<li><a href="/api/">API Reference</a></li>
							
								<li><a href="https://help.replicated.com/community/">Community</a></li>
							
							<li>
								<div class="search-form">
									<input type="text" placeholder="What are you looking for?" id="search-field" style="display: none;" />
									<span class="searchIcon--white" id="desktop-search"></span>
								</div>
							</li>
							<li class="log-in-link">
								<span><a href="https://vendor.replicated.com" target="_blank">Log in</a></span>
								
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</nav>
	</header>

	<main>
		<article class="single">
				
					<div class="u-gradient--redToRed main-section header flex-column flex1 justifyContent--center">
				
				<div class="container">
					<div class="paddingContainer">
						<div class="flex flex-auto u-width--full justifyContent--spaceBetween alignItems--center u-marginTop--more">
							<div class="u-width--full u-marginRight--more">
								<h1 class="u-color--white u-fontWeight--bold u-fontSize--header u-textAlign--left">Commands</h1>
								<p class="u-fontSize--normal u-fontWeight--medium u-color--white u-marginTop--normal u-lineHeight--normal">The config section of the Replicated YAML creates a dynamic settings page that customers can use to configure their instance.</p>
							</div>
							<div class="flex-auto u-hidden--mobileTablet">
								<span class="icon u- u-marginRight--normal"></span>
							</div>
						</div>
						
					</div>
				</div>
			</div>
			<div class="container">
				<div class="paddingContainer">
					<div class="u-flexTabletReflow flex1">
						<div class="flex-auto sidebar-wrapper">
							



<div class="sidebar">
        <div class="dropdown u-marginBottom--most">
            <p class="u-fontWeight--bold u-fontSize--largest u-color--tuna u-paddingBottom--normal">Documentation</p>
            <p class="u-fontSize--large u-fontWeight--medium u-cursor--pointer flex justifyContent--spaceBetween alignItems--center" id="dropdown-link">
                
                    <span>Config Screen</span>
                
                <span class="icon u-chevronIcon u-margingRight--small"></span>
            </p>
            <div class="menu" id="scheduler-dropdown-menu" style="display: none">
                <div class="u-paddingTop--small u-fontSize--normal u-fontWeight--bold u-color--curiousBlue u-paddingLeft--small">
                    <a href="/docs/native/getting-started/overview" class="u-color--curiousBlue">Replicated</a>
                    <div class="u-marginTop--small">
                        <a href="/docs/native/getting-started/overview" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Native Scheduler</p>
                        </a>
                        <a href="/docs/kubernetes/getting-started/overview" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Kubernetes</p>
                        </a>
                        <a href="/docs/swarm/getting-started/overview" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Docker Swarm</p>
                        </a>
                    </div>
                </div>
                <div class="u-borderTop--gray u-paddingTop--normal u-marginTop--small u-fontSize--normal u-fontWeight--bold u-color--curiousBlue u-paddingLeft--small">
                    <a href="/docs/config-screen/config-yaml/" class="u-color--curiousBlue">Features</a>
                    <div class="u-marginTop--small">
                        <a href="/docs/config-screen/config-yaml/" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Config Screen</p>
                        </a>
                        <a href="/docs/snapshots/overview/" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Snapshots</p>
                        </a>
                        <a href="/docs/ldap-and-identity/overview/" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">LDAP & Identity Integration</p>
                        </a>
                        <a href="/docs/registry/security/" class="u-fontWeight--medium u-color--tuna u-fontSize--small">
                            <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Replicated Private Registry</p>
                        </a>
                    </div>
                </div>
                <div class="u-borderTop--gray u-paddingTop--normal u-marginTop--small u-fontSize--normal u-fontWeight--bold u-color--curiousBlue u-paddingLeft--small">
                    <a href="/docs/ship" class="u-fontWeight--medium u-color--tuna u-fontSize--normal">
                        <p class="scheduler-menu-item-sub" class="u-lineHeight--normal">Ship</p>
                    </a>
                </div>
            </div>
        </div>
        <div class="desktop-only">
            
            
            
            
            <div class="u-marginBottom--most">
              <h3 class="u-fontWeight--bold u-fontSize--large u-borderBottom--gray u-paddingBottom--normal u-marginBottom--normal">Config Screen</h3>
              
                  
                      <p class="u-paddingTop--small u-fontSize--normal u-lineHeight--normal">
                          <a href="/docs/config-screen/config-yaml/" class=" u-color--curiousBlue ">
                              Config Screen YAML
                          </a>
                      </p>
                  
                      <p class="u-paddingTop--small u-fontSize--normal u-lineHeight--normal">
                          <a href="/docs/config-screen/commands/" class=" u-color--curiousBlueDark u-fontWeight--bold ">
                              Commands
                          </a>
                      </p>
                  
                      <p class="u-paddingTop--small u-fontSize--normal u-lineHeight--normal">
                          <a href="/docs/config-screen/test-procs/" class=" u-color--curiousBlue ">
                              Test Procedures
                          </a>
                      </p>
                  
                  
              
            </div>
            
            
            
            
            
            
            
            
        </div>
    </div>

						</div>
						<div class="flex1 page-content-wrapper">
							<div class="page-content">
								

<p>The <code>cmds</code> section of the YAML allows you to leverage the power of external commands within your configuration. The sole purpose of these <code>cmds</code> is to generate data for input in the configuration screen.</p>

<p>A command takes a variable number of string arguments and returns an array of strings. We have created an API with some useful commands. There is also the option to run the command raw. This command will take any <code>raw</code> string input and run the command in an <a href="https://hub.docker.com/r/replicated/cmd/">Ubuntu Trusty container</a>.</p>

<p>The command is run at YAML import time only (during app installation &amp; during app updates).</p>

<p>Below is an example of a command that will generate a private key, a x509 certificate, and a random admin password that are used as configuration for our app.</p>

<pre><code class="language-yaml">cmds:
- name: cert_cmd_result
  cmd: cert
  args:
  - &quot;1024&quot;
- name: gen_secret_result
  cmd: random
  args:
  - &quot;32&quot;
</code></pre>

<pre><code class="language-yaml">config:
  ...
  items:
  - name: server_private_key
    title: Private key file
    type: file
    hidden: true
    data_cmd:
      name: cert_cmd_result
      value_at: 0
  - name: server_cert
    title: Certificate file
    type: file
    hidden: true
    data_cmd:
      name: cert_cmd_result
      value_at: 1
  - name: server_authority
    title: X.509 Signing Authority
    type: file
    hidden: true
    data_cmd:
      name: cert_cmd_result
      value_at: 2
  - name: admin_password
    title: Generated Admin Password
    type: text
    value_cmd:
      name: gen_secret_result
      value_at: 0
</code></pre>

<h1 id="available-commands">Available Commands</h1>


<h2 class="linked-headline" id="cert">
    <a href="/docs/config-screen/commands/#cert" class="anchor" id="#cert"></a>
    cert
</h2>


<p>Generates a private key and x509 certificate pair. The resulting certificate is signed by the master authority belonging to the local instance of the Replicated management container. The authority certificate is also returned by this command so that clients can verify the full X.509 chain.</p>

<p><em>Note 1</em>: The authority certificate is generated the first time the management container is run on a system.</p>

<p><em>Note 2</em>: If you do not pass-in your own domain or IP address values to this command, you&rsquo;ll need to make sure that your server is set up to ignore bad certificate chains.</p>

<p><em>Note 2 (long explanation)</em>: To properly verify the resulting certificate chain, the server using this new certificate must be accessible via the domains or the IP addresses encoded into the cert. You can specify these values as arguments to the cert command. If you don&rsquo;t, default values will be used, and the defaults will almost certainly not match the domain or IP address of the actual machine using the cert.</p>

<h3 id="arguments">Arguments</h3>

<ul>
<li>Key length: The length in bits of the private key. Default: 1024</li>
<li>Domains: Comma-separated list of domains for which this certificate is valid. Default: &ldquo;example.com&rdquo;</li>
<li>IP addresses: Comma-separated list of IP addresses for which this certificate is valid. Default: the IP address bound to eth0 on the machine running the Replicated management container.</li>
</ul>

<h3 id="return-value">Return value</h3>

<ul>
<li>0: The new PEM-encoded private key.</li>
<li>1: The new PEM-encoded certificate.</li>
<li>2: The PEM-encoded cert authority used to sign the new certificate.</li>
</ul>

<pre><code class="language-yaml">cmds:
- name: cert_cmd_result
  cmd: cert
  args:
  - &quot;4096&quot;
  - mycounterapp.com
</code></pre>


<h2 class="linked-headline" id="publicip">
    <a href="/docs/config-screen/commands/#publicip" class="anchor" id="#publicip"></a>
    publicip
</h2>


<p>Gets the public IP address of the agent server.</p>

<p>This function reaches out to an external service to acquire the ip and the result can then be written to a config item.</p>

<h3 id="return-value-1">Return value</h3>

<ul>
<li>0: Public IP address</li>
</ul>

<pre><code class="language-yaml">- name: host_ip
  cmd: publicip
  args: []
</code></pre>


<h2 class="linked-headline" id="random">
    <a href="/docs/config-screen/commands/#random" class="anchor" id="#random"></a>
    random
</h2>


<p>Generates a random string with the default charset [_A-Za-z0-9].</p>

<h3 id="arguments-1">Arguments</h3>

<ul>
<li>Length - The length of the string (default 16 characters).</li>
<li>Charset</li>
</ul>

<h3 id="return-value-2">Return value</h3>

<ul>
<li>0: Random string</li>
</ul>

<pre><code class="language-yaml">- name: hash_key
  cmd: random
  args:
  - &quot;64&quot;
  - &quot;[A-Za-z0-9]&quot;
</code></pre>


<h2 class="linked-headline" id="echo">
    <a href="/docs/config-screen/commands/#echo" class="anchor" id="#echo"></a>
    echo
</h2>


<p>Echos the first argument.</p>

<h3 id="arguments-2">Arguments</h3>

<ul>
<li>String to echo</li>
</ul>

<h3 id="return-value-3">Return value</h3>

<ul>
<li>0: String</li>
</ul>

<pre><code class="language-yaml">- name: hello_world
  cmd: echo
  args:
  - Hello World!
</code></pre>


<h2 class="linked-headline" id="raw">
    <a href="/docs/config-screen/commands/#raw" class="anchor" id="#raw"></a>
    raw
</h2>


<p>Runs command from a bash shell inside an &ldquo;ubuntu:trusty&rdquo; docker container. The docker image is hosted on dockerhub at <a href="https://hub.docker.com/r/freighter/cmd/">https://hub.docker.com/r/freighter/cmd/</a></p>

<h3 id="arguments-3">Arguments</h3>

<ul>
<li>Variable</li>
</ul>

<h3 id="return-value-4">Return value</h3>

<ul>
<li>0: String</li>
</ul>

<pre><code class="language-yaml">- name: hello_world
  cmd: raw
  args:
  - echo
  - Hello World!
</code></pre>

								<div class="prev-next-arrows justifyContent--spaceBetween flex u-marginTop--most">
									<div class="next flex u-textAlign--left">
										
											
												<a href="/docs/config-screen/config-yaml/">
													<span class="icon u-chevronIcon"></span>
													Config Screen YAML
												</a>
											
										
										</div>
										<div class="previous flex u-textAlign--right">
										
											
												<a href="/docs/config-screen/test-procs/">
													Test Procedures
													<span class="icon u-chevronIcon"></span>
												</a>
											
										
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div>
				
			</div>
		</article>
	</main>
	<footer>
		<div class="container">
			<div class="footer-items-wrapper">
        <div class="footer-list flex1 paddingContainer">
					<div class="footer-list-item">
  <div class="footer-item">
    <div class="u-paddingBottom--normal">
      <a target="_blank" class="u-cursor--pointer" href="https://www.replicated.com">
        <img width="130" src="/images/footer_logo@2x.png"/>
      </a>
    </div>
    <div class="u-fontSize--small u-color--dustyGray u-marginBottom--small u-hidden--mobileTablet">&copy; 2018 <a> &nbsp;Replicated Inc.</a></div>
    <div class="u-fontSize--small u-color--dustyGray u-hidden--mobileTablet">All Rights Reserved</div>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Help Center</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/guides">Guides</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/docs">Documentation</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="/api">API Reference</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://vendor.replicated.com/support">Contact Support</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Company</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.replicated.com">About Replicated</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://blog.replicated.com">Replicated Blog</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.replicated.com/careers">Careers</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover">RSS Feed</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">Contact</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://twitter.com/replicatedhq">Twitter</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="mailto:contact@replicated.com">Email</a></li>
    </ul>
  </div>
</div><div class="footer-list-item">
  <div class="footer-item">
    <p class="u-fontWeight--medium u-color--tuna">More</p>
    <ul>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://github.com/replicatedhq">GitHub</a></li>
      <li><a class="u-color--dustyGray u-textDecoration--underlineOnHover" href="https://www.enterpriseready.io">EnterpriseReady.io</a></li>
    </ul>
  </div>
</div>

        </div>
			</div>
		</div>
	</footer>

	
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-61084834-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
      </script>
    
 
	<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
	<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>

  
  

    
    
      
        <script src="/js/staging/autocomplete-search.js"></script>
      
      
    

  

	<script src="/js/prism.js"></script>
	<script>
		function toggleMenuClass() {
			this.classList.toggle("open");
			document.getElementById("headerLinks").classList.toggle("show");
		}
		const toggleMenu = document.getElementById("toggleNav");
		if (toggleMenu) {
			toggleMenu.addEventListener("click", toggleMenuClass);
		};
	</script>

  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <script src="/js/featherlight.min.js"></script>
	<script>
		$('#desktop-search').on("click", function () {
      if(!$('#search-field').is(":visible")) {
        $('#search-field').show("slide", { direction: "right" }, 300);
        $('#search-field').focus();
      }
		});

    $('#search-field').on("blur", function () {
      $(this).hide("slide", { direction: "right" }, 300);
    });

    $('#dropdown-link').on('click', function() {
      $('#scheduler-dropdown-menu').toggle();
    });

    $(document).on('click', function(e) {
      var target = e.target;
      if(target.id !== "dropdown-link") {
        $('#scheduler-dropdown-menu').hide();
      }
    });

    $('.tooltip').tooltip({
      position: {  my: "center bottom-10", at: "center top"  },
      show: { effect: "fade", duration: 200 },
      hide: { effect: "fade", duration: 200 }
    });
	</script>
</body>
</html>
